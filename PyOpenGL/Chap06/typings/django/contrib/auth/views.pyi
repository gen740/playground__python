"""
This type stub file was generated by pyright.
"""

from django.contrib.auth.decorators import login_required
from django.contrib.auth.forms import AuthenticationForm, PasswordChangeForm, PasswordResetForm, SetPasswordForm
from django.utils.decorators import method_decorator
from django.views.decorators.cache import never_cache
from django.views.decorators.csrf import csrf_protect
from django.views.decorators.debug import sensitive_post_parameters
from django.views.generic.base import TemplateView
from django.views.generic.edit import FormView

UserModel = ...
class SuccessURLAllowedHostsMixin:
    success_url_allowed_hosts = ...
    def get_success_url_allowed_hosts(self):
        ...
    


class LoginView(SuccessURLAllowedHostsMixin, FormView):
    """
    Display the login form and handle the login action.
    """
    form_class = AuthenticationForm
    authentication_form = ...
    redirect_field_name = ...
    template_name = ...
    redirect_authenticated_user = ...
    extra_context = ...
    @method_decorator(sensitive_post_parameters())
    @method_decorator(csrf_protect)
    @method_decorator(never_cache)
    def dispatch(self, request, *args, **kwargs):
        ...
    
    def get_success_url(self):
        ...
    
    def get_redirect_url(self):
        """Return the user-originating redirect URL if it's safe."""
        ...
    
    def get_form_class(self):
        ...
    
    def get_form_kwargs(self):
        ...
    
    def form_valid(self, form):
        """Security check complete. Log the user in."""
        ...
    
    def get_context_data(self, **kwargs):
        ...
    


class LogoutView(SuccessURLAllowedHostsMixin, TemplateView):
    """
    Log out the user and display the 'You are logged out' message.
    """
    next_page = ...
    redirect_field_name = ...
    template_name = ...
    extra_context = ...
    @method_decorator(never_cache)
    def dispatch(self, request, *args, **kwargs):
        ...
    
    def post(self, request, *args, **kwargs):
        """Logout may be done via POST."""
        ...
    
    def get_next_page(self):
        ...
    
    def get_context_data(self, **kwargs):
        ...
    


def logout_then_login(request, login_url=...):
    """
    Log out the user if they are logged in. Then redirect to the login page.
    """
    ...

def redirect_to_login(next, login_url=..., redirect_field_name=...):
    """
    Redirect the user to the login page, passing the given 'next' page.
    """
    ...

class PasswordContextMixin:
    extra_context = ...
    def get_context_data(self, **kwargs):
        ...
    


class PasswordResetView(PasswordContextMixin, FormView):
    email_template_name = ...
    extra_email_context = ...
    form_class = PasswordResetForm
    from_email = ...
    html_email_template_name = ...
    subject_template_name = ...
    success_url = ...
    template_name = ...
    title = ...
    token_generator = ...
    @method_decorator(csrf_protect)
    def dispatch(self, *args, **kwargs):
        ...
    
    def form_valid(self, form):
        ...
    


INTERNAL_RESET_SESSION_TOKEN = ...
class PasswordResetDoneView(PasswordContextMixin, TemplateView):
    template_name = ...
    title = ...


class PasswordResetConfirmView(PasswordContextMixin, FormView):
    form_class = SetPasswordForm
    post_reset_login = ...
    post_reset_login_backend = ...
    reset_url_token = ...
    success_url = ...
    template_name = ...
    title = ...
    token_generator = ...
    @method_decorator(sensitive_post_parameters())
    @method_decorator(never_cache)
    def dispatch(self, *args, **kwargs):
        ...
    
    def get_user(self, uidb64):
        ...
    
    def get_form_kwargs(self):
        ...
    
    def form_valid(self, form):
        ...
    
    def get_context_data(self, **kwargs):
        ...
    


class PasswordResetCompleteView(PasswordContextMixin, TemplateView):
    template_name = ...
    title = ...
    def get_context_data(self, **kwargs):
        ...
    


class PasswordChangeView(PasswordContextMixin, FormView):
    form_class = PasswordChangeForm
    success_url = ...
    template_name = ...
    title = ...
    @method_decorator(sensitive_post_parameters())
    @method_decorator(csrf_protect)
    @method_decorator(login_required)
    def dispatch(self, *args, **kwargs):
        ...
    
    def get_form_kwargs(self):
        ...
    
    def form_valid(self, form):
        ...
    


class PasswordChangeDoneView(PasswordContextMixin, TemplateView):
    template_name = ...
    title = ...
    @method_decorator(login_required)
    def dispatch(self, *args, **kwargs):
        ...
    


